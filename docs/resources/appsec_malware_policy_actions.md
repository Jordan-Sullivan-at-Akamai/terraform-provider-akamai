---
layout: "akamai"
page_title: "Akamai: Malware Policy Action"
subcategory: "Application Security"
description: |-
  Malware Policy Action
---

# akamai_appsec_malware_policy_action

**Scopes**: Malware protection

Creates, modifies, or deletes the actions associated with one or more policies within a given security policy.
By default, malware policies take no action when triggered.
Note that you must set separate actions for requests that are scanned according to the specified malware policy and those that are unscanned.

**Related API Endpoint**: [/appsec/v1/configs/{configId}/versions/{versionNumber}/security-policies/{policyId}/malware-policies](https://techdocs.akamai.com/application-security/reference/put-malware-policy-actions)

## Example Usage

Basic usage:

```
terraform {
  required_providers {
    akamai = {
      source = "akamai/akamai"
    }
  }
}

provider "akamai" {
  edgerc = "~/.edgerc"
}
// USE CASE: User wants to create a malware policy and malware policy actions for a security configuration.

data "akamai_appsec_configuration" "configuration" {
  name = "Documentation"
}
resource "akamai_appsec_malware_policy" "appsec_malware_policy" {
  config_id      = data.akamai_appsec_configuration.configuration.config_id
  malware_policy = file("${path.module}/malware_policy.json")
}
resource "akamai_appsec_malware_policy_actions" "appsec_malware_policy_actions" {
  config_id              = data.akamai_appsec_configuration.configuration.config_id
  security_policy_id     = "gms1_134637"
  malware_policy_actions = file("${path.module}/malware_policy_actions.json")
}
```

## Argument Reference

This resource supports the following arguments:

- `config_id` (Required). Unique identifier of the security configuration associated with the malware policy action being modified.
- `security_policy_id` (Required). Unique identifier of the security policy associated with the malware policy whose action is being modified.
- `malware_policy_actions` (Required). Path to a JSON file containing the malware policy IDs and their respective actions. A sample JSON file can be found in the [Modify malware policy actions for a security policy](https://developer.akamai.com/api/cloud_security/application_security/v1.html#putsecuritypolicyactions) section of the Application Security API documentation.
